[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R Package Essentials",
    "section": "",
    "text": "About this\nThis is a book on the essential components of creating an R package. It is aimed at those who want to learn how to make R packages. You probably have written some functions, but if you haven‚Äôt, we discuss how to do that. I care a lot about writing functions, and have a lot of thoughts and ideas on how to do it.\nIt was initially developed as a full-day hour workshop, ‚ÄúR package essentials‚Äù. It is a developed into a resource that will grow and change over time as a living book.\nThis book aims to teach the following:",
    "crumbs": [
      "About this"
    ]
  },
  {
    "objectID": "index.html#licence",
    "href": "index.html#licence",
    "title": "R Package Essentials",
    "section": "Licence",
    "text": "Licence\nThis work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    "crumbs": [
      "About this"
    ]
  },
  {
    "objectID": "license.html",
    "href": "license.html",
    "title": "License",
    "section": "",
    "text": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    "crumbs": [
      "License"
    ]
  },
  {
    "objectID": "philosophy.html",
    "href": "philosophy.html",
    "title": "1¬† Philosophy",
    "section": "",
    "text": "I first learnt to write an R package from [Hilary Parker‚Äôs famous blog post, ‚ÄúWriting an R package from scratch‚Äù. Then I consulted Hadley Wickham‚Äôs ‚ÄúR packages‚Äù book (1st edition). I consider the ‚ÄúR packages‚Äù book (now in its second edition, by Hadley Wickham and Jenny Bryan), to be the authority on best practices for package development, alongside the rOpenSci guide, ‚ÄúrOpenSci Packages: Development, Maintenance, and Peer Review‚Äù.\nThese are excellent pieces of reference test, however I think there is a need for a resource that sits somewhere between a blog post on making an R package, and resource. I want something that contains just enough information to get you started on the right path to making an R package. This is what that book represents to me. Along the way I‚Äôll include breadcrumbs to other resources to look into when you want to learn more.\nThis book also represents my efforts to explain the key parts of what I think people should know about how to write functions, and also to format this in a teachable way that can be covered in a single workshop.\n\nSo, why write a book?\n\nSimilar to my book, ‚ÄúQuarto for Scientists‚Äù, writing this as a book provides a nice way to structure the content in the form of a workshop, in a way suitable for learning in a day. It is not to say that there aren‚Äôt already the resources out there; there are. It is instead adding to the list of other (useful, hopefully!) information out there on the internet. To answer a question with another question: ‚ÄúWhy NOT write this as a book?‚Äù",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Philosophy</span>"
    ]
  },
  {
    "objectID": "installation.html",
    "href": "installation.html",
    "title": "2¬† Installation",
    "section": "",
    "text": "2.1 Overview\nIn this section, the aim is to have everyone setup with R, RStudio, the tools you need to build an R package, and git.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Installation</span>"
    ]
  },
  {
    "objectID": "installation.html#overview",
    "href": "installation.html#overview",
    "title": "2¬† Installation",
    "section": "",
    "text": "Duration 15 minutes",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Installation</span>"
    ]
  },
  {
    "objectID": "installation.html#questions",
    "href": "installation.html#questions",
    "title": "2¬† Installation",
    "section": "2.2 Questions",
    "text": "2.2 Questions\n\nHow do I install R?\nHow do I install RStudio\n\nWhat about Positron?\n\nHow do I install git?\nHow do I install RTools?",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Installation</span>"
    ]
  },
  {
    "objectID": "installation.html#software-setup",
    "href": "installation.html#software-setup",
    "title": "2¬† Installation",
    "section": "2.3 Software Setup",
    "text": "2.3 Software Setup\n\n2.3.1 Installing R\n\nWindowsMacOSLinux\n\n\nhttps://cloud.r-project.org/bin/windows/\n\n\nhttps://cloud.r-project.org/bin/macosx/\n\n\nhttps://cloud.r-project.org/bin/linux/\n\n\n\n\n\n2.3.2 Installing RStudio\nhttps://posit.co/download/rstudio-desktop/#download\n\n\n2.3.3 Installing R packages for development\nTo ensure you are up to date, run the following script to install the packages.\n\ninstall.packages(c(\"devtools\", \"roxygen2\", \"testthat\", \"knitr\", \"pak\"))\n\n\n2.3.3.1 Personalising your R Profile\nThis is really neat, and I think it‚Äôs actually worthwhile doing, but it does take up some time, and there are some warnings.\nAs you develop R packages, you‚Äôll need to go through a cycle of restarting R, and loading things up to be ready. One of the issues with this is that you‚Äôll find yourself writing code like:\n\nlibrary(devtools)\n\nA lot. To save you time, we can edit a very special file called ‚ÄúThe R profile‚Äù, which is saved as .RProfile. This code is special, and awesome, because it is run every time you start R. It is also dangerous, for exactly the same reason.\nI recommend running the following code from devtools to help set this up:\nuse_devtools()\nWhich will bring up the following message:\n‚òê Include this code in .Rprofile to make devtools\n  available in all interactive sessions:\n  if (interactive()) {\n    suppressMessages(require(devtools))\n  }\n  [Copied to clipboard]\n‚òê Modify /Users/nick/.Rprofile.\n‚òê Restart R for changes to take effect.\nSo, copy and paste the above, which I will now explain. There are three parts to this that I will break down:\nrequire(devtools)\nwe usually recommend writing library(devtools), but in this instance, require is what we want, because if the package is not installed, require will throw a warning, rather than an error:\n\n# warn\nrequire(whatevenisthis)\n\nLoading required package: whatevenisthis\n\n\nWarning in library(package, lib.loc = lib.loc, character.only = TRUE,\nlogical.return = TRUE, : there is no package called 'whatevenisthis'\n\n# error\nlibrary(whatevenisthis)\n\nError in library(whatevenisthis): there is no package called 'whatevenisthis'\n\n\nWe do not want an error when we start R, it is annoying.\nsuppressMessages()\nThis code suppresses any messages that appear from running this code, which again, we want, because we don‚Äôt (generally) want our R session to announce something upon startup.\n  if (interactive()) {\n    suppressMessages(require(devtools))\n  }\nThis means that this code is only run if the R session is interactive. This always felt a bit strange to me - because I had only ever run R interactively. But you don‚Äôt want to run require(devtools) when we aren‚Äôt using R interactively, because it means we are potentially changing the state of things. Essentially, it‚Äôs good practice.\nAlso, here are a couple of times that you might not realise you are using R non-interactively:\n\nrendering a document using quarto or rmarkdown\nbuilding an R package (which you‚Äôll learn about later)\n\nYou also use R non-interactively when you are running Rscript in the command line.\nFinally, another bit of useful code in your R profile is something like this:\n# usethis options\noptions(\n  usethis.full_name = \"Nicholas Tierney\",\n  usethis.protocol = \"https\",\n  usethis.description = list(\n    `Authors@R` = '\n    c(\n      person(\n        given = \"Nicholas\",\n        family = \"Tierney\",\n        role = c(\"aut\", \"cre\"),\n        email = \"nicholas.tierney@gmail.com\",\n        comment = c(ORCID = \"https://orcid.org/0000-0003-1460-8722\")\n      )\n    )',\n    License = \"MIT + file LICENSE\",\n    Language = \"en-GB\",\n    Version = \"0.0.0.9000\"\n  ),\n  # set SI to true\n  reprex.session_info = TRUE\n)\nThis helps when setting up your R package for the first time, to make sure you set up your DESCRIPTION file. It isn‚Äôt required, but it is neat, and I think worthwhile.\nBecause I need to set these things up on different laptops sometimes, I actually write all these files to github. They are typically called ‚Äúdotfiles‚Äù - you can see mine at http://github.com/njtierney/dotfiles.\n\n\n\n2.3.4 git and github\nVery briefly, git is essentially a way of managing versions and changes. You can think of it like a product such as dropbox, but with super powers. You can go back in time, you can make copies for changing, and delicately and precisely mege them back in, or leave them where they are.\nYour software needs a home. You‚Äôll typically start with your project on your laptop or computer. GitHub is where you can store it online. The benefits to sharing your work on github are many, but my personal top reasons are:\n\nBuild trust in your software. If the community can see your code, they can trust it better.\nProvides a way to log ideas and bugs via issues.\nProvides a way for the community to contribute to your code.\n\nMy favourite book on using git and github with R is the book ‚Äúhappy git with R‚Äù By Jenny Bryan, Jim Hester, and the Stat 545 TAs. Honestly, it‚Äôs hard to recommend better installation instructions than their battle tested ones, so I‚Äôll point you to this resource in case you run into troubles here.\n\n2.3.4.1 setting up github\nGetting set up on github you need an account. It‚Äôs easy enough to set up - go to https://github.com/ . When picking a username, I recommend the following:\n\nKeep it short. jsmith is better than jonathansmith.\nAvoid numbers and jokes. jsmith is better than jsmith123\nKeep it professional. jsmithisthebest\nKeep it lowercase DONOTSHOUT\n\n\n\n2.3.4.2 installing git\nInstalling git can sometimes be a challenge. This is largely because sometimes there are small differences that arise to install windows vs mac vs linux. Or sometimes there are issues with work computers with strong permissions.\nGenerally, you should install git from: https://git-scm.com/downloads\nBut, if you encounter issues, I would advise checking out the battle-tested instructions at: https://happygitwithr.com/install-git.\nOnce you‚Äôve installed git, I recommend running this:\n\nusethis::git_vaccinate()\n\n‚úî Configuring 'core.excludesFile': '~/.gitignore'\n\n\n‚úî Creating the global (user-level) gitignore: '~/.gitignore'\n\n\n‚úî Adding \".Rproj.user\", \".Rhistory\", \".Rdata\", \".httr-oauth\", \".DS_Store\", and\n  \".quarto\" to '/home/runner/.gitignore'.\n\n\nWhich ensures that you ignore specific files (specifically, Rproj.user, .Rhistory, .Rdata, .httr-oauth, .DS_Store, and .quarto). This is important because it decreases your chances of leaking credentials or other important details to GitHub.\n\n\n2.3.4.3 The ‚Äúgit handshake‚Äù\nIn order for your computer to talk to git and github properly, it needs to know three things:\n\nName\nEmail\nCredentials\n\ngit needs to know your name and email - this should be the name and email you used to set up your github account. Set this up with use_git_config()\n\nlibrary(usethis)\nuse_git_config(\n  user.name = \"Ned Kelly\", \n  user.email = \"ned@example.org\"\n)\n\ngithub needs a personal access token - this is so you can talk to github from R. This becomes really handy, and dare I say it, nearly magical later on. To get this, run:\nusethis::create_github_token()\nThis will open up GitHub and create a Personal Access Token. If this doesn‚Äôt work, go to https://github.com/settings/tokens and click ‚ÄúGenerate New Token‚Äù, and select the (classic).‚Äù\nGenerally speaking you want the following scopes selected:\n\n‚Äúrepo‚Äù\n‚Äúuser‚Äù\n‚Äúworkflow‚Äù.\n\nA token will be created - keep this page open, and copy the token to your clipboard.\nThen, go to R, and run:\ngitcreds::gitcreds_set()\nAnd paste this PAT code in. Then, verify all of this with:\nusethis::git_sitrep()\n\n\n\n2.3.5 Installing RTools\nThis is actually something that you only need to do if you want to use C or C++ with your R package, which isn‚Äôt something you need to do for this course. To read more on this, see ‚ÄúThe R build toolchain‚Äù from the R Packages book.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Installation</span>"
    ]
  },
  {
    "objectID": "rstudio.html",
    "href": "rstudio.html",
    "title": "3¬† RStudio, What and Why",
    "section": "",
    "text": "3.1 Overview\n(This section is also in my other book, ‚ÄúQuarto for Scientists‚Äù)",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>RStudio, What and Why</span>"
    ]
  },
  {
    "objectID": "rstudio.html#overview",
    "href": "rstudio.html#overview",
    "title": "3¬† RStudio, What and Why",
    "section": "",
    "text": "Teaching 5 minutes\nExercises 2 minutes",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>RStudio, What and Why</span>"
    ]
  },
  {
    "objectID": "rstudio.html#questions",
    "href": "rstudio.html#questions",
    "title": "3¬† RStudio, What and Why",
    "section": "3.2 Questions",
    "text": "3.2 Questions\n\nWhat is RStudio?\nWhy should I use RStudio?\nWhat features should I change?",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>RStudio, What and Why</span>"
    ]
  },
  {
    "objectID": "rstudio.html#objectives",
    "href": "rstudio.html#objectives",
    "title": "3¬† RStudio, What and Why",
    "section": "3.3 Objectives",
    "text": "3.3 Objectives\n\nGet familiarised with RStudio\nGet set up with not storing the RStudio workspace\nDownload the course materials for the workshop",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>RStudio, What and Why</span>"
    ]
  },
  {
    "objectID": "rstudio.html#what-is-rstudio-and-why-should-i-use-it",
    "href": "rstudio.html#what-is-rstudio-and-why-should-i-use-it",
    "title": "3¬† RStudio, What and Why",
    "section": "3.4 What is RStudio, and why should I use it?",
    "text": "3.4 What is RStudio, and why should I use it?\n\nIf R is the engine and bare bones of your car, then RStudio is like the rest of the car.\n\nThe engine is super critical part of your car. But in order to make things properly functional, you need to have a steering wheel, comfy seats, a radio, rear and side view mirrors, storage, and seatbelts. RStudio is all those niceties\nThe RStudio layout has the following features:\n\nOn the upper left, the Quarto script\nOn the lower left, the R console\nOn the lower right, the view for files, plots, packages, help, and viewer.\nOn the upper right, the environment / history pane\n\n\n\n\n\n\nA screenshot of the RStudio working environment.\n\n\n\n\nWe saw a bit of what an Quarto script does.\n\nThe R console is the bit where you can run your code.\nThe file/plot/package viewer is a handy browser for your current files, like Finder, or File Explorer.\nPlots are where your plots appear, you can view packages, see the help files.\nThe environment / history pane contains the list of things you have created, and the past commands that you have run.\n\n\n\n\n\n\n\nYour Turn: RStudio default options\n\n\n\nTo first get set up, I highly recommend changing the following setting\nTools &gt; Global Options (or Cmd + , on macOS)\nUnder the General tab:\n\nFor workspace:\n\nUncheck restore .RData into workspace at startup.\nSave workspace to .RData on exit : ‚ÄúNever‚Äù.\n\nFor History:\n\nUncheck ‚ÄúAlways save history (even when not saving .RData).\nUncheck ‚ÄúRemove duplicate entries in history‚Äù.\n\n\n\n\n\nSetting the options right for RStudio, so you don‚Äôt restore previous sessions work, and don‚Äôt save it either.\n\n\nThis means that you won‚Äôt save the objects and other things that you create in your R session and reload them. This is important for two reasons\n\nReproducibility: you don‚Äôt want to have objects from last week cluttering your session\nPrivacy: you don‚Äôt want to save private data or other things to your session. You only want to read these in.\n\nYour ‚Äúhistory‚Äù is the commands that you have entered into R.\nAdditionally, not saving your history means that you won‚Äôt be relying on things that you typed in the last session, which is a good habit to get into!",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>RStudio, What and Why</span>"
    ]
  },
  {
    "objectID": "rstudio.html#learning-more",
    "href": "rstudio.html#learning-more",
    "title": "3¬† RStudio, What and Why",
    "section": "3.5 Learning more",
    "text": "3.5 Learning more\n\nRStudio IDE cheatsheet",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>RStudio, What and Why</span>"
    ]
  },
  {
    "objectID": "workflow.html",
    "href": "workflow.html",
    "title": "4¬† Workflow",
    "section": "",
    "text": "4.1 Overview\n(Note that this section is borrowed from my book, Quarto for Scientists: ‚Äúworkflow‚Äù)\nWe can prevent unexpected problems if we can maintain an order to your files, paths, and directories. A common problem that arises is R not knowing where a certain file is. For example, we get the error:\nBecause R doesn‚Äôt know where \"my-very-important-data-file-somewhere.csv\" is.\nPracticing good file storage hygiene will help maintain an order to files, paths, and directories. This will make you more productive in the future, because you‚Äôll spend less time fighting against file paths.\nNot sure what a file path is? We explain that as well.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html#overview",
    "href": "workflow.html#overview",
    "title": "4¬† Workflow",
    "section": "",
    "text": "Teaching 10 minutes\nExercises 10 minutes",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html#questions",
    "href": "workflow.html#questions",
    "title": "4¬† Workflow",
    "section": "4.2 Questions",
    "text": "4.2 Questions\n\nWhere should I put all my files?\nWhat is an RStudio project, anyway?\nWhat is a file path?",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html#objectives",
    "href": "workflow.html#objectives",
    "title": "4¬† Workflow",
    "section": "4.3 Objectives",
    "text": "4.3 Objectives\n\nUnderstand what a file path is\nSet up an RStudio Project to organise your work\nPut some data in your project to set up the next tasks\n\n\n\n\n\n\n\nYour Turn\n\n\n\nIn groups of 2-4 discuss:\n\nWhat your normal ‚Äúworkflow‚Äù is for starting a new project\nPossible challenges that might arise when maintaining your project",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html#when-you-start-a-new-project-open-a-new-rstudio-project",
    "href": "workflow.html#when-you-start-a-new-project-open-a-new-rstudio-project",
    "title": "4¬† Workflow",
    "section": "4.4 When you start a new project: Open a new RStudio project",
    "text": "4.4 When you start a new project: Open a new RStudio project\nThis section is heavily influenced by Jenny Bryan‚Äôs great blog post on project based workflows.\nSometimes this is the first line of an R Script or R markdown file.\nsetwd(\"c:/really/long/file/path/to/this/directory\")\n\n\n\n\n\n\nQuestion\n\n\n\nWhat do you think the setwd code does?\n\n\n\n4.4.1 So what does this do?\nThis says, ‚Äúset my working directory to this specific working directory‚Äù.\nIt means that you can read in data and other things like this:\ndata &lt;- read_csv(\"data/mydata.csv\")\nInstead of\ndata &lt;- read_csv(\"c:/really/long/file/path/to/this/directory/data/mydata.csv\")\nSo while this has the effect of making the file paths work in your file, it is a problem. It is a problem because, among other things, using setwd() like this:\n\nHas 0% chance of working on someone else‚Äôs machine (this could include you in 6 months!)\nYour file is not self-contained and portable. (Think: ‚ÄúWhat if this folder moved to /Downloads, or onto another machine?‚Äù)\n\nSo, to get this to work, you need to hand edit the file path to your machine.\nThis is painful.\nWhen you do this all the time, it gets old, fast.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html#what-is-a-file-path",
    "href": "workflow.html#what-is-a-file-path",
    "title": "4¬† Workflow",
    "section": "4.5 What is a file path?",
    "text": "4.5 What is a file path?\nThis might all be a bit confusing if you don‚Äôt know what a file path is. A file path is the machine-readable directions to where files on your computer live. So, the file path:\n/Users/njtierney/Desktop/qmd4sci-materials/demo.R\nDescribes the location of the file ‚Äúdemo.R‚Äù. This could be visualised as:\nusers\n  ‚îî‚îÄ‚îÄ njtierney\n      ‚îî‚îÄ‚îÄ Desktop\n          ‚îî‚îÄ‚îÄ  qmd4sci-materials\n               ‚îî‚îÄ‚îÄ demo.R &lt;&lt; THIS IS THE FILE HERE\n               ‚îî‚îÄ‚îÄ exercises\n               ‚îî‚îÄ‚îÄ exploratory-data-analysis\n                   ‚îî‚îÄ‚îÄ eda-document.qmd\n                   ‚îî‚îÄ‚îÄ eda-script.R\n               ‚îî‚îÄ‚îÄ  data\n                    ‚îî‚îÄ‚îÄ  gapminder.csv\nSo, if you want to read in the gapminder.csv file, you might need to write code like this:\ngapminder &lt;- read_csv(\"/Users/njtierney/Desktop/qmd4sci-materials/data/gapminder.csv\")\nAs we now know, this is a problem, because this is not portable code. It is unlikely someone else will have the gapminder.csv data stored under the folders, \"Users/njtierney/Desktop\".\nIf you have an RStudio project file inside the qmd4sci-materials folder, you can instead write the following:\ngapminder &lt;- read_csv(\"data/gapminder.csv\")\n\n\n\n\n\n\nYour Turn\n\n\n\n\n(1-2 minutes) Imagine you see the following directory path: \"/Users/miles/etc1010/week1/data/health.csv\" what are the folders above the file, health.csv?\nWhat would be the result of using the following code in demo-gapminder.qmd, and then using the code, and then moving this to another location, say inside your C drive?\n\nsetwd(\"Downloads/etc1010/week1/week1.qmd)",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html#is-there-an-answer-to-the-madness",
    "href": "workflow.html#is-there-an-answer-to-the-madness",
    "title": "4¬† Workflow",
    "section": "4.6 Is there an answer to the madness?",
    "text": "4.6 Is there an answer to the madness?\nThis file path situation is a real pain. Is there an answer to the madness?\nThe answer is yes!\nI highly recommend when you start on a new idea, new research project, paper. Anything that is new. It should start its life as an rstudio project.\nAn rstudio project helps keep related work together in the same place. Amongst other things, they:\n\nKeep all your files together.\nSet the working directory to the project directory.\nStarts a new session of R.\nRestore previously edited files into the editor tabs.\nRestore other rstudio settings.\nAllow for multiple R projects open at the same time.\n\nThis helps keep you sane, because:\n\nYour projects are each independent.\nYou can work on different projects at the same time.\nObjects and functions you create and run from project idea won‚Äôt impact one another.\n\nYou can refer to your data and other projects in a consistent way.\n\nAnd finally, the big one:\nRStudio projects help resolve file path problems, because they automatically set the working directory to the location of the rstudio project.\nLet‚Äôs open one together.\n\n\n\n\n\n\nYour Turn Use your own rstudio project\n\n\n\n\nIn RStudio, and run the following code to start a new rstudio project called ‚Äúqmd4sci-materials‚Äù.\n\nusethis::use_course(\"njtierney/qmd4sci-materials\")\n\nFollow the prompts to download this to your desktop and then run the rstudio project. (You can move it later if you like!)\nYou are now in an rstudio project!\n\n\n\n\n\n\n\n\n\nYour Turn: open the demo.R file\n\n\n\n\nRun the code inside the demo.R file\nWhy does the read_csv code work?\nRun the code inside the exploratory-data-analysis folder - eda-script.R.\nDoes the read_csv code work?\nRun the code inside the exploratory-data-analysis folder - eda-document.qmd, by clicking the ‚Äúrender‚Äù button (we‚Äôll go into this in more detail soon!)\nDoes it work?",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html#the-here-package",
    "href": "workflow.html#the-here-package",
    "title": "4¬† Workflow",
    "section": "4.7 The ‚Äúhere‚Äù package",
    "text": "4.7 The ‚Äúhere‚Äù package\nAlthough RStudio projects help resolve file path problems, in some cases you might have many folders in your r project. To help navigate them appropriately, you can use the here package to provide the full path directory, in a compact way.\nhere::here(\"data\")\nreturns\n[1] \"/Users/nick/github/njtierney/qmd4sci-materials/data\"\nAnd\nhere::here(\"data\", \"gapminder.csv\")\nreturns\n[1] \"/Users/nick/github/njtierney/qmd4sci-materials/data/gapminder.csv\"\n(Note that these absolute file paths will indeed be different on my computer compared to yours - super neat!)\nYou can read the above here code as:\n\nIn the folder data, there is a file called gapminder.csv, can you please give me the full path to that file?\n\nThis is really handy for a few reasons:\n\nIt makes things completely portable\nQuarto documents have a special way of looking for files, this helps eliminate file path pain.\nIf you decide to not use RStudio projects, you have code that will work on any machine",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html#remember",
    "href": "workflow.html#remember",
    "title": "4¬† Workflow",
    "section": "4.8 Remember",
    "text": "4.8 Remember\n\nIf the first line of your R script is\n\nsetwd(\"C:\\Users\\jenny\\path\\that\\only\\I\\have\")\n\nI will come into your office and SET YOUR COMPUTER ON FIRE üî•.\n\n‚Äì Jenny Bryan\n\n\n\n\n\n\nAside: Creating an RStudio project\n\n\n\n\n\nYou can create an Rstudio project by going to:\nfile &gt; new project &gt; new directory &gt; new project &gt; name your project &gt; create project.\nYou can also click on the create project button in the top left corner\n\n\n\n\n\n\n\n\n\nThen go to new directory, if it is a new folder - otherwise if you have an existing folder you have - click on existing directory.\n\n\n\n\n\n\n\n\n\nThen go to new project\n\n\n\n\n\n\n\n\n\nThen write the name of your project. I think it is usually worthwhile spending a bit of time thinking of a name for your project. Even if it is only a few minutes, it can make a difference. You want to think about:\n\nKeeping it short.\nNo spaces.\nCombining words.\n\nFor example, I had a project looking at bat calls, so I called it screech, because bats make a screech-y noise. But maybe you‚Äôre doing some global health analysis so you call it ‚Äúworld-health‚Äù.\nAnd click ‚Äúcreate project‚Äù.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Workflow</span>"
    ]
  },
  {
    "objectID": "why-functions.html",
    "href": "why-functions.html",
    "title": "5¬† Why functions?",
    "section": "",
    "text": "5.1 Overview\nAt their core, an R package is a way to share code. The way we share that code is primarily through R functions. There is a lot about the mechanics, and the tools to create and write R packages, but what I want to communicate here is the what, why, when, and how of using functions.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#overview",
    "href": "why-functions.html#overview",
    "title": "5¬† Why functions?",
    "section": "",
    "text": "Teaching 20 minutes\nExercises 15 minutes",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#questions",
    "href": "why-functions.html#questions",
    "title": "5¬† Why functions?",
    "section": "5.2 Questions",
    "text": "5.2 Questions\n\nWhat is a function?\nWhy should I use a function?\nWhen should I use a function?\nHow do I create a function?",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#objectives",
    "href": "why-functions.html#objectives",
    "title": "5¬† Why functions?",
    "section": "5.3 Objectives",
    "text": "5.3 Objectives\n\nUnderstand why functions should be used\nUnderstand when do use functions\nUnderstand how to write functions",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#prior-art",
    "href": "why-functions.html#prior-art",
    "title": "5¬† Why functions?",
    "section": "5.4 Prior Art",
    "text": "5.4 Prior Art\nThere‚Äôs a lot of work and thought that‚Äôs gone into writing functions. A lot of my own understanding of this has been informed by others, and I want to make sure I properly acknowledge them:\n\nJoe Cheng: You have to be able to reason about it\nHadley Wickham‚Äôs ‚ÄòMany Models‚Äô talk\nHadley Wickham‚Äôs ‚ÄòThe design of everyday functions‚Äô\nMiles Mcbain‚Äôs ‚ÄòOur colour of magic‚Äô\nJenny Bryan‚Äôs ‚ÄòCode Smells and Feels‚Äô\nRoger Peng‚Äôs ‚ÄòFrom tapply to Tidyverse‚Äô\nAdvanced R: Functions\nTidy Design Principles\nLexical Scope and Statistical Computing\nstat545 chapter on functions\n\nThese are all well worth the time reading, or watching these. If I had to pick two of the most influential, I would say:\n\nHadley Wickham‚Äôs ‚ÄúMany Models‚Äù talk, and\nJenny Bryan‚Äôs ‚ÄúCode Smells and Feels‚Äù",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#code-is-for-people",
    "href": "why-functions.html#code-is-for-people",
    "title": "5¬† Why functions?",
    "section": "5.5 Code is for people",
    "text": "5.5 Code is for people\nIf I could have you walk away with one key idea, it would be this:\n\nFunctions are tools to manage complexity that allow us to reason with and understand our code.\n\nIn essence, code is for people. This stems from a famous (well, I think it‚Äôs famous), quote:\n\n[W]e want to establish the idea that a computer language is not just a way of getting a computer to perform operations but rather that it is a novel formal medium for expressing ideas about methodology. Thus, programs must be written for people to read, and only incidentally for machines to execute.\n\n‚Äî Structure and Interpretation of Computer Programs. Abelson, Sussman, and Sussman, 1984.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#ok-but-what-actually-is-a-function",
    "href": "why-functions.html#ok-but-what-actually-is-a-function",
    "title": "5¬† Why functions?",
    "section": "5.6 OK, but what actually is a function?",
    "text": "5.6 OK, but what actually is a function?\nGoing back to my quote:\n\nFunctions are tools to manage complexity that allow us to reason with and understand our code.\n\nI actually think before we talk about the anatomy, the what. We first must discuss why functions.\nA function is something that helps us manage complexity. You can think about this as something that allows us to repeat certain tasks. Kind of like how a robot, or a manufacturing line can repeat manual tasks.\nLet‚Äôs say we had some data on age groups - the number of contacts these people record on a given day.\n\noptions(tidyverse.quiet=TRUE)\nlibrary(tidyverse)\ncontact &lt;- tibble(\n  location = rep(c(\"QLD\", \"NSW\"), 3),\n  age_groups = c(\"15-19\", \"15--19\", \"20--24\", \"20-24\", \"25---29\", \"25-29\"),\n  n_contacts = c(100, 125, 150, 200, 225, 250)\n)\n\ncontact\n\n# A tibble: 6 √ó 3\n  location age_groups n_contacts\n  &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;\n1 QLD      15-19             100\n2 NSW      15--19            125\n3 QLD      20--24            150\n4 NSW      20-24             200\n5 QLD      25---29           225\n6 NSW      25-29             250\n\n\nWe want to produce a plot of age groups and the number of contacts.\nBut, we can‚Äôt do this, because there are all these different ways of representing ‚Äúage_group‚Äù.\n\nggplot(\n  contact,\n  aes(x = age_groups,\n      y = n_contacts)) + \n  geom_col()\n\n\n\n\n\n\n\n\nWell rather, we CAN do this, but we want to get the totals of each age group.\nWhat we want out of this is them all to be separated out by an underscore ‚Äú_‚Äú, and turned into a factor:\n\nlibrary(stringr)\ntidy_contact &lt;- contact |&gt; \n  mutate(\n    age_groups = str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      ),\n    age_groups = as.factor(age_groups)\n  )\n\ntidy_contact\n\n# A tibble: 6 √ó 3\n  location age_groups n_contacts\n  &lt;chr&gt;    &lt;fct&gt;           &lt;dbl&gt;\n1 QLD      15_19             100\n2 NSW      15_19             125\n3 QLD      20_24             150\n4 NSW      20_24             200\n5 QLD      25_29             225\n6 NSW      25_29             250\n\n\nAnd then we can plot this:\n\nggplot(\n  tidy_contact,\n  aes(x = age_groups,\n      y = n_contacts)) + \n  geom_col()\n\n\n\n\n\n\n\n\nSure, job done.\nBut now we have some new data, this one contains similar information, but it has population data that we need to join onto it so we can get proportion information.\n\npopulation &lt;- tibble(\n  location = rep(c(\"QLD\", \"NSW\"), 3),\n  age_groups = c(\"15--19\", \"15-19\", \"20---24\", \"20-24\", \"25-29\", \"25--29\"),\n  population = c(319014, 468550, 338824, 540233, 370468, 607891)\n)\n\npopulation\n\n# A tibble: 6 √ó 3\n  location age_groups population\n  &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;\n1 QLD      15--19         319014\n2 NSW      15-19          468550\n3 QLD      20---24        338824\n4 NSW      20-24          540233\n5 QLD      25-29          370468\n6 NSW      25--29         607891\n\n\nAnd this is why I think you should write a function.\nWe want to encapsulate the idea of cleaning up age group. That is: ‚Äúclean age groups‚Äù. So let‚Äôs write a function that captures this idea.\n\nclean_age_groups &lt;- function(age_groups){\n  \n  age_underscore &lt;- str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      )\n  as.factor(age_underscore)\n  \n}\n\nAnd this is the difference in the worflow, for each of these, script, or function tidying up processes:\n\nscriptfunction\n\n\n\ntidy_contact &lt;- contact |&gt; \n  mutate(\n    age_groups = str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      ),\n    age_groups = as.factor(age_groups)\n  )\n\ntidy_population &lt;- population |&gt; \n  mutate(\n    age_groups = str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      ),\n    age_groups = as.factor(age_groups)\n  )\n\ntidy_proportion &lt;- tidy_contact |&gt; \n  left_join(tidy_population,\n             by = c(\"location\", \"age_groups\")) |&gt; \n  mutate(proportion = n_contacts / population)\n  \n\ntidy_proportion\n\n# A tibble: 6 √ó 5\n  location age_groups n_contacts population proportion\n  &lt;chr&gt;    &lt;fct&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n1 QLD      15_19             100     319014   0.000313\n2 NSW      15_19             125     468550   0.000267\n3 QLD      20_24             150     338824   0.000443\n4 NSW      20_24             200     540233   0.000370\n5 QLD      25_29             225     370468   0.000607\n6 NSW      25_29             250     607891   0.000411\n\n\n\n\n\nclean_age_groups &lt;- function(age_groups){\n  \n  age_underscore &lt;- str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      )\n  as.factor(age_underscore)\n  \n}\n\ntidy_contact &lt;- contact |&gt; \n  mutate(\n    age_groups = clean_age_groups(age_groups)\n  )\n\ntidy_population &lt;- population |&gt; \n  mutate(\n    age_groups = clean_age_groups(age_groups)\n  )\n\ntidy_proportion &lt;- tidy_contact |&gt; \n  left_join(tidy_population,\n             by = c(\"location\", \"age_groups\")) |&gt; \n  mutate(proportion = n_contacts / population)\n\n\n\n\n\n5.6.1 Functions give ideas a home\nFunctions provide a way to express the idea of what we want to do. They also provide your ideas a home. What if the data changes? Do you want to go back and change each line of code? No! You can update the function in one place, and then repeat it again.\nOnce you start writing functions to do things, they will start to be little repositories of knowledge. Little shortcuts that you can use to just remember the most important part.\nNow, on to the anatomy of functions",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#anatomy-of-a-function",
    "href": "why-functions.html#anatomy-of-a-function",
    "title": "5¬† Why functions?",
    "section": "5.7 Anatomy of a function",
    "text": "5.7 Anatomy of a function\nNow, to speak about the mechanics of writing functions: a function is composed of three parts:\n\nName\nArguments\nBody\n\nTo look at our clean_age_groups function again, we can see the following:\n\n# The name of the function\nclean_age_groups &lt;- function(age_groups){ # The argument - age_groups\n  \n  # The body of the function\n  age_underscore &lt;- str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      )\n  \n  # The last thing you do with the function is what it returns\n  as.factor(age_underscore)\n  \n}\n\n\n\n\n\n\n\nThe last thing you do shouldn‚Äôt be assignment &lt;-\n\n\n\n\n\nThe last thing that a function does is what it returns. If we take our example above and change the last line to assign to some variable, then the function will not return anything!\n\n# The name of the function\nclean_age_groups &lt;- function(age_groups){ # The argument - age_groups\n  \n  # The body of the function\n  age_underscore &lt;- str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      )\n  \n  # The last thing you do with the function is what it returns\n  factored &lt;- as.factor(age_underscore)\n  \n}\n\nclean_age_groups(\"10--11\")\n\nThis is a pretty common mistake, one I still make‚Äìsomething to be aware of!\nThe way to fix this is to make sure that the last thing you do isn‚Äôt assigned. So, our example above should look like so:\n\n# The name of the function\nclean_age_groups &lt;- function(age_groups){ # The argument - age_groups\n  \n  # The body of the function\n  age_underscore &lt;- str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      )\n  \n  # The last thing you do with the function is what it returns\n  # NOT THIS\n  # factored &lt;- as.factor(age_underscore)\n  # THIS\n  as.factor(age_underscore)\n  \n}\n\nclean_age_groups(\"10--11\")\n\n[1] 10_11\nLevels: 10_11",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#how-to-think-about-writing-functions",
    "href": "why-functions.html#how-to-think-about-writing-functions",
    "title": "5¬† Why functions?",
    "section": "5.8 How to think about writing functions",
    "text": "5.8 How to think about writing functions\nThere are many ways to start writing functions.\nFundamentally, it is about identifying inputs and outputs.\nOne useful approach, I think, is to identify the outputs before the inputs:\n\nThe output. What one thing do you want this function to return?\nThe input. What (potentially many) thing(s) go in to this.\n\nThis ‚Äúgestalt‚Äù, or top-down approach isn‚Äôt how it always needs to be done. But I think it helps you identify the thing you need first, which can help guide you.\n\n5.8.1 Identifying the output - what do we need?\nIt might feel a bit like putting the cart before the horse, but I think there is a nice advantage to thinking about the output first: you focus on what you want the function to do.\nIn the case of our clean_age_groups function, we want to get values like ‚Äú15_19‚Äù that are factors.\n\n\n5.8.2 Identifying the input\nSo now we have a clear idea of what we need - we can now clarify what we have, which in our case earlier, was some contact data\n\ncontact\n\n# A tibble: 6 √ó 3\n  location age_groups n_contacts\n  &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;\n1 QLD      15-19             100\n2 NSW      15--19            125\n3 QLD      20--24            150\n4 NSW      20-24             200\n5 QLD      25---29           225\n6 NSW      25-29             250\n\n\nWhere we want to focus on age groups, and take inputs like\n\nc(\"15-19\", \"15--19\")\n\n[1] \"15-19\"  \"15--19\"\n\n\nAnd then turn them into:\n\nc(\"15_19\", \"15_19\")\n\n[1] \"15_19\" \"15_19\"\n\n\nBreaking things down like this means we can focus on a really small example of the thing we want, which makes the problem easier to solve.\nThere are many ways to manage turning strings into other strings, and I like to use the stringr package to do this. We can use the str_replace_all function. So I‚Äôll start by scratching up some inputs like so, and seeing if this works\n\nages &lt;- c(\"15-19\", \"15--19\")\nstr_replace_all(\n  string = ages,\n  pattern = \"-\",\n  replacement = \"_\"\n)\n\n[1] \"15_19\"  \"15__19\"\n\n\nNot quite what I‚Äôm after - I‚Äôve got two underscores when I want just one.\n\n5.8.2.1 Iteration: Writing functions is writing\nI didn‚Äôt get this right the first time - and I rarely do! The point I want to make here is:\n\nWriting functions is just like writing. It takes iteration.\n\nWe have incidentally replaced every - with _, which means -- becomes __.\nLet‚Äôs change that by using | in the ‚Äúpattern‚Äù argument, which allows us to specify -|--, which means, - OR --:\n\nages &lt;- c(\"15-19\", \"15--19\")\nstr_replace_all(\n  string = ages,\n  pattern = \"-|--\",\n  replacement = \"_\"\n)\n\n[1] \"15_19\"  \"15__19\"\n\n\nOK, the same problem. We actually need to flip the order here, so we change -- first:\n\nages &lt;- c(\"15-19\", \"15--19\")\nstr_replace_all(\n  string = ages,\n  pattern = \"--|-\",\n  replacement = \"_\"\n)\n\n[1] \"15_19\" \"15_19\"\n\n\nGreat! Now let‚Äôs put that into the body of the function, and give the function a good name.\n\nclean_age_groups &lt;- function(age_groups){\n  str_replace_all(\n  string = ages,\n  pattern = \"--|-\",\n  replacement = \"_\"\n)\n}\n\nclean_age_groups(ages)\n\n[1] \"15_19\" \"15_19\"\n\n\nIt‚Äôs a useful process to scratch out a function like this. As you get more confident with this, you will start to be able to write the code as a function first, and then iterate in that way.\n\n\n\n\n\n\nbeware copying and pasting into functions\n\n\n\n\n\nThe process of writing a function out in scratchings as we‚Äôve done, is that we can leave some scraps in the code. In this case, I‚Äôve actually left the ages object in the function, but the argument is age_groups:\n\nclean_age_groups &lt;- function(age_groups){\n  str_replace_all(\n  string = ages,\n  pattern = \"--|-\",\n  replacement = \"_\"\n)\n}\n\nclean_age_groups(ages)\n\n[1] \"15_19\" \"15_19\"\n\n\nNotice that this still works! This is because the ages object still exists as a variable I‚Äôve created. But if we try another input, we‚Äôll get some strange output:\n\nclean_age_groups(c(\"10-12\", \"10--12\"))\n\n[1] \"15_19\" \"15_19\"\n\n\nSo, make sure to clean up after you‚Äôve copied and pasted - remember to check the arguments match how they are used in the function.\nAnd on that note, let‚Äôs redefine clean_age_groups correctly so we don‚Äôt get an error later on (which happened during the development of the book)\n\nclean_age_groups &lt;- function(age_groups){\n  str_replace_all(\n  string = age_groups,\n  pattern = \"--|-\",\n  replacement = \"_\"\n)\n}\n\nclean_age_groups(ages)\n\n[1] \"15_19\" \"15_19\"\n\n\n\n\n\n\n\n\n5.8.3 Managing scope - functions are best (generally) when they do one thing\nAlso, note that we wrote clean_age_groups to just focus on converting input like ‚Äú10‚Äì12‚Äù into ‚Äú10_12‚Äù. We could have instead focussed on cleaning up the data frame, like so:\n\ncontact\n\n# A tibble: 6 √ó 3\n  location age_groups n_contacts\n  &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;\n1 QLD      15-19             100\n2 NSW      15--19            125\n3 QLD      20--24            150\n4 NSW      20-24             200\n5 QLD      25---29           225\n6 NSW      25-29             250\n\nclean_age_groups_data &lt;- function(data){\n  \n  tidy_contact &lt;- data |&gt; \n  mutate(\n    age_groups = str_replace_all(\n      string = age_groups, \n      pattern = \"---|--|-\",\n      replacement = \"_\"\n      ),\n    age_groups = as.factor(age_groups)\n  )\n  \n  tidy_contact\n\n}\n\nclean_age_groups_data(contact)\n\n# A tibble: 6 √ó 3\n  location age_groups n_contacts\n  &lt;chr&gt;    &lt;fct&gt;           &lt;dbl&gt;\n1 QLD      15_19             100\n2 NSW      15_19             125\n3 QLD      20_24             150\n4 NSW      20_24             200\n5 QLD      25_29             225\n6 NSW      25_29             250\n\n\nI think there are a couple of issues with this:\n\nWe assume the age groups column is always age_groups\nThe scope is now larger - we are always working with data and returning data\nWe haven‚Äôt necessarily made the expression easier.\n\nIt is fine to wrap up the existing function into another function that cleans the data - to me this better encapsulates and expresses the ideas:\n\ncontact\n\n# A tibble: 6 √ó 3\n  location age_groups n_contacts\n  &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;\n1 QLD      15-19             100\n2 NSW      15--19            125\n3 QLD      20--24            150\n4 NSW      20-24             200\n5 QLD      25---29           225\n6 NSW      25-29             250\n\nclean_contacts &lt;- function(data){\n  \n  data |&gt; \n  mutate(\n    age_groups = clean_age_groups(age_groups)\n  )\n\n}\n\nclean_contacts(contact)\n\n# A tibble: 6 √ó 3\n  location age_groups n_contacts\n  &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;\n1 QLD      15_19             100\n2 NSW      15_19             125\n3 QLD      20_24             150\n4 NSW      20_24             200\n5 QLD      25__29            225\n6 NSW      25_29             250\n\n\nSome of the improvements I notice\n\nWe are just focussing on cleaning up the age group column.\nWe have given it a name that refers to cleaning up the data, which might also give us some space and room to add more cleaning function here.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#when-to-function",
    "href": "why-functions.html#when-to-function",
    "title": "5¬† Why functions?",
    "section": "5.9 When to function",
    "text": "5.9 When to function\nOne of my overall points with functions is:\n\nfunctions help you express your intention.\n\nHowever, there are some generally good heuristics to follow to help guide you towards writing a function. Generally, it is time to write a function if:\n\nYou‚Äôve copied and pasted the code 3 or more times.\nYou‚Äôve re-read your code more than 3 times.\n\nThis first principle is often called DRY - ‚ÄúDon‚Äôt Repeat Yourself.\nThe second principle has been coined by Miles McBain, also as DRY, or possibly DRRY: Don‚Äôt ReRead Yourself.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#naming-things-is-hard",
    "href": "why-functions.html#naming-things-is-hard",
    "title": "5¬† Why functions?",
    "section": "5.10 Naming things is hard",
    "text": "5.10 Naming things is hard\n\nThere are only two hard things in Computer Science: cache invalidation and naming things.\n\n‚Äì Phil Karlton\nWhat does this function do?\n\nmyfun &lt;- function(x){\n  (x * 9/5) + 32\n}\n\nConverting temperature?\n\ntemperature_conversion &lt;- function(x){\n  (x * 9/5) + 32\n}\n\nClearly state input_to_output()\n\ncelcius_to_fahrenheit &lt;- function(x){\n  (x * 9/5) + 32\n}\n\nName argument and intermediate variables\n\ncelcius_to_fahrenheit &lt;- function(celcius){\n  fahrenheit &lt;- (celcius * 9/5) + 32\n  fahrenheit\n}\n\nWhat, what does make functions hard?\n\ncelcius_to_fahrenheit &lt;- function(celcius){\n  (celcius * 9/5) + 32\n}\n\nIdentifying inputs and outputs is hard.\nBut what is hard it taking code, (like the code in a data analysis) and finding the parts that need to change\n\nThere‚Äôs a level of ‚ÄúI got it to work‚Äù and there‚Äôs a level of ‚ÄúIt works, and I can reason about it‚Äù\n\n‚Äì Joe Cheng You have to be able to reason about it | Data Science Hangout\nI can reason about it\n\n‚Ä¶how do you take all this complexity and break it down into smaller pieces‚Ä¶each of which you can reason about‚Ä¶each of which you can hold in your head‚Ä¶each of which you can look at and be like ‚Äúyup, I can fully ingest this entire function definition, I can read it line by line and prove to myself this is definitely correct‚Ä¶So software engineering‚Ä¶ is a lot about this: How do you break up inherently complicated things that we are trying to do into small pieces that are individually easy to reason about. That‚Äôs half the battle‚Ä¶The other half of the battle is how do we combine them in ways that can be reliable and also easy to reason about",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#the-other-hard-part-of-writing-functions",
    "href": "why-functions.html#the-other-hard-part-of-writing-functions",
    "title": "5¬† Why functions?",
    "section": "5.11 The other hard part of writing functions",
    "text": "5.11 The other hard part of writing functions\n\n\n\n\n\n\nPractice naming things\n\n\n\n\n\nGive names to the following functions:\n\nthingy &lt;- function(x){\n  x^3\n}\n\nbobby &lt;- function(x){\n  str_replace_all(\n    string = x,\n    pattern = \"‚Äú\",\n    replacement = '\"'\n  )\n}\n\nf &lt;- function(x) {\n  ux &lt;- unique(x)\n  ux[which.max(tabulate(match(x, ux)))]\n}\n\n\n\n\nGenerally speaking, it is good to following a naming convention of some kind, and also to keep the names descriptive:\n\n# good\nfit_lm()\nfit_cart()\nfit_glm()\n\n# less good - tab complete isn't as good, unless we have a lot of functions also named `lm` and `cart`, and `glm`. We don't emphasize things\nlm_fit()\ncart_fit()\nglm_fit()\n\n# bad\nflm()\nfcart()\nfglm()",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "why-functions.html#conclusion",
    "href": "why-functions.html#conclusion",
    "title": "5¬† Why functions?",
    "section": "5.12 Conclusion",
    "text": "5.12 Conclusion\nThe process of writing a function is:\n\nIdentify outputs and inputs\nIdentify the complexity to abstract away\nWriting functions is iterative, Just like regular writing\nNaming things is hard. Focus on making ‚Äúslightly better‚Äù names.\n\nOn a final note, I think it‚Äôs worthwhile thinking about the iteration - and the idea of moving from a skateboard to a car, rather than building the car:\n\n\n\n\n\n(heard via Stat545 functions chapter)",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Why functions?</span>"
    ]
  },
  {
    "objectID": "motivation.html",
    "href": "motivation.html",
    "title": "6¬† Motivation",
    "section": "",
    "text": "6.1 Overview\nWe‚Äôve gone through a lot of setup, and now we‚Äôre going to start building an R package. Soon. But we need to have some motivation, first. It involves a bit of a story, and a bit of imagination.",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#overview",
    "href": "motivation.html#overview",
    "title": "6¬† Motivation",
    "section": "",
    "text": "Teaching 30 minutes\nExercises 10 minutes",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#questions",
    "href": "motivation.html#questions",
    "title": "6¬† Motivation",
    "section": "6.2 Questions",
    "text": "6.2 Questions\n\nHow to convert code into functions?",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#objectives",
    "href": "motivation.html#objectives",
    "title": "6¬† Motivation",
    "section": "6.3 Objectives",
    "text": "6.3 Objectives\n\nStart to wrangle with a script to turn it into functions",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#how-this-works",
    "href": "motivation.html#how-this-works",
    "title": "6¬† Motivation",
    "section": "6.4 How this works",
    "text": "6.4 How this works\nOne of my big goals with teaching functions, and with teaching R packages, is that I want the examples to be somewhat rooted in the familiar and the real. There are really useful toy examples of writing packages that deliver praise (e.g., ones I‚Äôve used to teach R packages in the past: https://github.com/njtierney/praiseme), or do simple conversions between units (celcius to farenheit being a very common example).\nThese examples are useful because they teach you the tools, and the process. However in this course, I want to focus on a bit more than this and incorporate the process of turning code into functions. I think this is important, because it more closely represents other examples we come across in using R, and presents a bit of a richer learning journey, because in addition to learning about the tools and the process of R package building, you will also learn:\n\nHow to think about converting scripts to functions\nHow to write better functions\n\nI have written up some example code, which starts as a quarto document. We are going to take this document, and then eventually turn it into an R package.\nThe structure of this exercise has taken inspiration from ‚ÄúThe package within‚Äù chapter from R Packages.",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#the-example-learned",
    "href": "motivation.html#the-example-learned",
    "title": "6¬† Motivation",
    "section": "6.5 The example: ‚Äúlearned‚Äù",
    "text": "6.5 The example: ‚Äúlearned‚Äù\nWe are going to be looking at a role-play situation where we imagine we are at some fictional workplace, where part of our job is to look at education data that we have acquired from some source. The overall goal of our job here is to produce some key outputs from some data.\nYou can see this example at: https://github.com/njtierney/learned\nTo download it, run the following code\n\nlibrary(usethis)\nuse_course(\"njtierney/learned\")\n\n\n\n\n\n\n\nYour turn\n\n\n\n\nDownload the repository using the code above\nRender the document, ‚Äúanalysis2014.qmd‚Äù\nRead over the document, thinking about what we discussed in Why functions.\nIdentify some potential problems with the code\nThink about what might happen if we want to read in data from 2015 (or later years), how would you like to do this?",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#discussion-of-potential-problems",
    "href": "motivation.html#discussion-of-potential-problems",
    "title": "6¬† Motivation",
    "section": "6.6 Discussion of potential problems",
    "text": "6.6 Discussion of potential problems\nAfter you‚Äôve taken from time to think about some of the potential problems, open the box below\n\n\n\n\n\n\nSome of the potential problems\n\n\n\n\n\n\nCopying and pasting a document could lead to errors\nWhat if the data changes?\nWhat if other people collaborate on this project? How do they have the source of truth?\nIs there a way to formalise this all?",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#identifying-the-report-outputs",
    "href": "motivation.html#identifying-the-report-outputs",
    "title": "6¬† Motivation",
    "section": "6.7 Identifying the report outputs",
    "text": "6.7 Identifying the report outputs\nTo get us started with some key things, let‚Äôs think about what the key outputs of this report are.\n\n\n\n\n\n\nYour turn\n\n\n\n\nIdentify the key outputs of the report\nPick one of those key outputs and start to write out a function for it\n\n\n\n\n\n\n\n\n\nKey outputs\n\n\n\n\n\nThey key outputs are related to the ‚ÄúProduce a ‚Ä¶‚Äù steps of the document:\n\nProduce a plot of the proportion of people educated in each age group in each state\nProduce a box plot of proportion of people educated for each state.\nProduce a table of The 5 number summary (min, 1st quantile, median, 3rd quantile, max) of proportion of people educated for each state.\n\n\n\n\nSo now we know where we are headed - we want to write some functions that produce these plots and tables.\nHowever, the main problem that we encountered was that there was actually a bit of data cleaning that needed to happen before we did this. Let‚Äôs focus on cleaning up and rearranging the quarto document first to identify the data cleaning steps required.\n\n\n\n\n\n\nYour turn\n\n\n\n\nOpen, ‚Äúalpha-analysis2014.qmd‚Äù\nMove all the ‚Äúdata quality‚Äù checks into a new section called ‚Äúdata quality‚Äù\nMove all of the data cleaning code up to the top, so we just work with one data set, named tidy_age_state_education_2014\nCreate two functions to clean the data:\n\ntidy the age groups\nremove the missing values\n\nPut these two functions into another function that does the data cleaning",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#discussion-of-data-cleaning-function-implementations",
    "href": "motivation.html#discussion-of-data-cleaning-function-implementations",
    "title": "6¬† Motivation",
    "section": "6.8 Discussion of data cleaning function implementations",
    "text": "6.8 Discussion of data cleaning function implementations\n\nDiscuss ‚Äúsolutions-alpha-analysis2014.qmd‚Äù",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#applying-functions-to-give-the-outputs",
    "href": "motivation.html#applying-functions-to-give-the-outputs",
    "title": "6¬† Motivation",
    "section": "6.9 Applying functions to give the outputs",
    "text": "6.9 Applying functions to give the outputs\nWe‚Äôve got some data cleaning functions! Now let‚Äôs see if we can capture the intention of the plots, and wrap these up into functions, too.\nThe overall idea here is that we can capture the overall intention of what we are doing in a concise way, that is easy to reason with. That is not to say that it is just smaller, but being easy to reason with is key here.\n\n\n\n\n\n\nYour turn\n\n\n\n\nOpen, ‚Äúbravo-analysis2014.qmd‚Äù\nWrite a function for each of the following:\n\nBar plot of proportion of people educated by state and age\nBoxplot of proportion of people educated for each state\nTable of 5 number summary of proportion of people educated for each state\n\nMove all these functions to the top of the document into a single code chunk labelled ‚Äúfunctions‚Äù\nMove the ‚Äúdata checks‚Äù to the end of the document. We will come back to this later\nMake a ‚Äúlibraries‚Äù code chunk and put the library call in there",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#discussion-of-plot-and-table-rearranging-functions",
    "href": "motivation.html#discussion-of-plot-and-table-rearranging-functions",
    "title": "6¬† Motivation",
    "section": "6.10 Discussion of plot and table, rearranging functions",
    "text": "6.10 Discussion of plot and table, rearranging functions\n\nWhat do we notice now?",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#moving-towards-a-quasi-package.",
    "href": "motivation.html#moving-towards-a-quasi-package.",
    "title": "6¬† Motivation",
    "section": "6.11 Moving towards a quasi-package.",
    "text": "6.11 Moving towards a quasi-package.\nWe‚Äôre slowly isolating the parts of the code that we care about, and now we‚Äôre going to make an incremental change again - to move all of the functions out to an R folder, with one function per R file.\nFor those who are more familiar with R Packages, this might start to look a lot more like an R package - while this isn‚Äôt the ‚Äústandard‚Äù process, the intention here is to demonstrate the key changes:\n\nFunctions: Identifying points of expression / abstraction\nClearly expressing functions\nUsing functions to clearly articulate your work\n\n\n\n\n\n\n\n‚Äòergonomic‚Äô / interactive helper packages\n\n\n\nTo do package development, we‚Äôre going to be using packages like devtools and usethis. These packages are things we use in the console - we use them interactively. They help us automate a lot of things, so we can focus on the task at hand.\nYou can be almost guaranteed that we will use any functions from devtools and usethis in the console. It‚Äôs OK for that to feel strange! It will feel better soon.\n\n\n\n\n\n\n\n\nYour turn\n\n\n\n\nOpen ‚Äúcharlie-analysis2014.qmd‚Äù\nUse use_r() from devtools/usethis to create a separate R file for each of the R functions:\n\nclean_age_groups\nclean_education_data\nplot_study_age_state\nboxplot_study_state\nsummarise_prop_study\n\nload all of these R functions, by calling source at the top of the quarto document",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "motivation.html#discussion",
    "href": "motivation.html#discussion",
    "title": "6¬† Motivation",
    "section": "6.12 Discussion",
    "text": "6.12 Discussion\n\nThoughts on this process?\nShall we just get to the making the R package?\nSee https://github.com/njtierney/learned/pull/1 for solution\n\nNow, let‚Äôs move to making the R package!",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Motivation</span>"
    ]
  },
  {
    "objectID": "create-the-pkg.html",
    "href": "create-the-pkg.html",
    "title": "7¬† Create the package!",
    "section": "",
    "text": "7.1 create_package(here))\nIt‚Äôs happening! We‚Äôre nearly there!\nWe‚Äôve lined things up, now it‚Äôs time to start tearing down some walls, and getting things ready to be an R package.\nInside of the learned repository, run:\nThis says:\nYou get a note that it does the following\nPersonally, I recommend No, there‚Äôs not really a point to this in this instance.\nThere‚Äôs a bit to unpack here, you can see these new things have been created!\nThere are three files added, which I‚Äôll briefly discuss, and then we can move on to more substantial matters of cleaning this directory up a little bit.",
    "crumbs": [
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Create the package!</span>"
    ]
  },
  {
    "objectID": "create-the-pkg.html#create_packagehere",
    "href": "create-the-pkg.html#create_packagehere",
    "title": "7¬† Create the package!",
    "section": "",
    "text": "create_package(here::here(), open = FALSE)\n\n\nCreate a package in this directory, and don‚Äôt open a new RStudio session, please\n\n\n‚úî Setting active project to\n  \"/Users/nick/github/njtierney/learned\".\n‚úî Writing DESCRIPTION.\n‚úî Writing NAMESPACE.\n! Overwrite pre-existing file learned.Rproj?\n\n‚Ñπ Leaving learned.Rproj unchanged.\n‚úî Adding \"^learned\\\\.Rproj$\" to .Rbuildignore.\n‚úî Adding \"^\\\\.Rproj\\\\.user$\" to .Rbuildignore.\n‚úî Setting active project to \"&lt;no active project&gt;\".\n\n\nSee changes at this commit\n\n\n\n7.1.1 DESCRIPTION file\nMy DESCRIPTION file looks like this, initially\nPackage: learned\nTitle: What the Package Does (One Line, Title Case)\nVersion: 0.0.0.9000\nAuthors@R: \n    person(\"Nicholas\", \"Tierney\", , \"nicholas.tierney@gmail.com\", role = c(\"aut\", \"cre\"),\n           comment = c(ORCID = \"https://orcid.org/0000-0003-1460-8722\"))\nDescription: What the package does (one paragraph).\nLicense: MIT + file LICENSE\nEncoding: UTF-8\nLanguage: en-GB\nRoxygen: list(markdown = TRUE)\nRoxygenNote: 7.3.2\nEssentially, this is a bunch of metadata about the package. It is a very critical file to an R package, and we‚Äôll come back to it later. For the moment, I think there are two things worth noting:\n\nIt‚Äôs a bunch of metadata that is really important and specifically formatted\nThe DESCRIPTION details here have my name and a few other things set (like Language: en-GB), because of where we set this up in installation.\n\n\n\n7.1.2 .Rbuildignore\nThis lists files that we don‚Äôt want to package up when we eventually build our R package.\nThis contains:\n^learned\\.Rproj$\n^\\.Rproj\\.user$\nWhich are specific RStudio files. As you get further along in the package building process, more files will be added to .Rbuildignore.\n\n\n7.1.3 NAMESPACE\nAnother super critical file. We don‚Äôt touch it by hand. It gets updated automatically via devtools and usethis. It looks like this currently:\n# Generated by roxygen2: do not edit by hand",
    "crumbs": [
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Create the package!</span>"
    ]
  },
  {
    "objectID": "create-the-pkg.html#some-housekeeping",
    "href": "create-the-pkg.html#some-housekeeping",
    "title": "7¬† Create the package!",
    "section": "7.2 Some housekeeping",
    "text": "7.2 Some housekeeping\nWe need to really tidy up this repository to be an R package. There is stuff everywhere.\n\n7.2.1 Move the data to data-raw\nLet‚Äôs clean up all the existing data and move it into a special data-raw folder. The data-raw folder exists in R packages as a place to hold original copies of data that will eventually be cleaned up and shared in the data folder. For the time being, we can store our data sets in here, and we‚Äôll come back to it later.\n\n\n\n\n\n\nYour turn\n\n\n\n\nRun use_data_raw()\nMove raw_education_2014...2019.csv into the newly created data-raw folder\n\n\n\n\n7.2.1.1 Running use_data_raw()\nWhen we run use_data_raw(), we get a message like the following:\n‚úî Setting active project to\n  \"/Users/nick/github/njtierney/learned\".\n‚úî Creating data-raw/.\n‚úî Adding \"^data-raw$\" to .Rbuildignore.\n‚úî Writing data-raw/DATASET.R.\n‚òê Modify data-raw/DATASET.R.\n‚òê Finish writing the data preparation script in\n  data-raw/DATASET.R.\n‚òê Use `usethis::use_data()` to add prepared data\n  to package.\nThis is the usethis package‚Äôs way of telling us a couple of nifty things:\n\nDATASET.R is a file it has created, this is where you document changes to the data before it gets saved into the data folder\nthe data folder gets created with usethis::use_data() - we will come back to this.\n\nA takeaway point from this is that the usethis package is quite chatty, and quite helpful!\n\nYou can see my initial commit of use_data_raw().\n\n\n\n7.2.1.2 Move CSVs into data-raw/\nThere‚Äôs a few ways to do this, personally, I just use RStudio‚Äôs file interface and move the files around. - Here‚Äôs what that commit looks like. Note, that this is effectively a renaming, so there‚Äôs not much going on in this commit.\n\n\n\n7.2.2 Delete old quarto files, move one into vignettes\nWe don‚Äôt need the alpha-bravo-charlie of it all anymore, we can just stick with one. We‚Äôre going to move it to a special folder called a ‚Äúvignette‚Äù. We‚Äôre going to shelve it there for a little bit.\n\n\n\n\n\n\nYour turn\n\n\n\n\nDelete ‚Äúanalysis2014.qmd‚Äù and associated HTML/folders\nDelete ‚Äúalpha-analysis2014.qmd‚Äù and associated HTML/folders\nDelete ‚Äúbravo-analysis2014.qmd‚Äù and associated HTML/folders\n(potentially move ‚Äúsolution-charlie-analysis2014.qmd‚Äù) into root level and delete ‚Äúcharlie-analysis2014.qmd‚Äù)\nDelete ‚Äúsolutions‚Äù folder\nrun use_vignette(\"analysis-2014\")\n\n\n\n\n7.2.2.1 deleting old files\nHere‚Äôs the commit of deleting and moving files, and deleting solutions folder\n\ncommit deleting and moving files\ncommit deleting solutions folder\n\n\n\n7.2.2.2 Creating quarto vignettes\nOnce we run\nuse_vignette(\"analysis-2014\")\nWe get another nice chatty message from usethis:\n‚úî Adding knitr to Suggests field in DESCRIPTION.\n‚úî Adding \"inst/doc\" to .gitignore.\n‚úî Adding rmarkdown to Suggests field in\n  DESCRIPTION.\n‚úî Adding \"knitr\" to VignetteBuilder.\n‚úî Creating vignettes/.\n‚úî Adding \"*.html\" and \"*.R\" to\n  vignettes/.gitignore.\n‚úî Writing vignettes/analysis-2014.Rmd.\n‚òê Modify vignettes/analysis-2014.Rmd.\nYou can see the commit for this\nNote that although we started with a Quarto vignette, it opened an Rmarkdown vignette. It is actually possible to use a quarto vignette - as described in the Quarto R package.\nAnd, just because I want this to be more on the side of bleeding-edge erring to timeless, we‚Äôre going to do that.\nThere‚Äôs a few steps, so hold on.\n\n7.2.2.2.1 update VignetteBuilder\nOpen the DESCRIPTION file, and replace knitr with quarto in VignetteBuilder.\n\ncommit\n\nThen, copy our ‚Äúsolution/charlie-analysis.qmd‚Äù file into vignette folder\n\ncommit\n\nThen, add some of the appropriate metadata into the quarto YAML:\n\ncommit\n\nFinally, delete the other Rmd file, and rename ours ‚Äúanalysis-2014.qmd‚Äù\n\ncommit\n\nIt‚Äôs worthwhile noting that this vignette in its current state will not build properly, but we will get to it later.",
    "crumbs": [
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Create the package!</span>"
    ]
  },
  {
    "objectID": "create-the-pkg.html#buildinstall-the-package",
    "href": "create-the-pkg.html#buildinstall-the-package",
    "title": "7¬† Create the package!",
    "section": "7.3 Build/install the package",
    "text": "7.3 Build/install the package\nNow, we have a package! This will actually build, and install! Although we still need to do a few things to make it useable, it‚Äôs worthwhile celebrating the small steps!\n\n\n\n\n\n\nYour turn\n\n\n\nBuild the package by navigating to the ‚Äúbuild‚Äù pane in the top right:\n\nClick this, and see some text like the following appear!\n==&gt; R CMD INSTALL --preclean --no-multiarch --with-keep.source learned\n\n* installing to library ‚Äò/Users/nick/Library/R/arm64/4.4/library/_build‚Äô\n* installing *source* package ‚Äòlearned‚Äô ...\n** using staged installation\n** R\n** byte-compile and prepare package for lazy loading\nNo man pages found in package  ‚Äòlearned‚Äô \n** help\n*** installing help indices\n** building package indices\n** installing vignettes\n** testing if installed package can be loaded from temporary location\n** testing if installed package can be loaded from final location\n** testing if installed package keeps a record of temporary installation path\n* DONE (learned)\n\n\nLet‚Äôs celebrate this win, and also wrap up this long section on a slight cliffhanger: let‚Äôs try using our package.",
    "crumbs": [
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Create the package!</span>"
    ]
  },
  {
    "objectID": "create-the-pkg.html#the-workflow-of-package-development.",
    "href": "create-the-pkg.html#the-workflow-of-package-development.",
    "title": "7¬† Create the package!",
    "section": "7.4 The workflow of package development.",
    "text": "7.4 The workflow of package development.\nOne of the major workflows during R package development is this:\n\nEdit R functions\nload_all() (or keyboard shortcut Ctrl/Cmd+Shift+L)\nEdit R functions.\n\n\n\n\n\n\n\nCheatsheets\n\n\n\n\n\nThere is a great cheatsheet for package development that I had stapled to my cubicle wall during my PhD. The website now is very useful, but make sure to check out the PDF.\n\n\n\nLet‚Äôs try out our R package. To do this, I‚Äôm going to recommend you create a special R file, sometimes called a ‚Äúscratch file‚Äù. It lives inside a folder called inst, which is typically not touched by R package building. This is a useful trick if you want to have a way to play around with some R code, keeping it inside your R package.\n\n\n\n\n\n\nYour turn\n\n\n\n\n\nCreate a scratch file:\n\nCreate a directory inst\nInside that directory, create an R file called scratch.R (note that this can actually be called anything, but scratch.R is what I use)\nWrite library(learned) inside scratch.R\nRead in the raw education 2014 data from data-raw, and use one of the functions from the R package, like clean_education_data(). What happens when you use this?\n\n\n\n\nSee the commit for this\nIf you‚Äôre like me, I got this error:\n&gt; clean_education_data(raw_education_2014)\nError in mutate(data, age_group = clean_age_groups(age_group), prop_studying = na_if(prop_studying,  : \n  could not find function \"mutate\"\nLet‚Äôs pick this up in the next section, ‚ÄúHow to use extra packages‚Äù\n\n\n\n\n\n\nThis is a non-standard way of making an R package\n\n\n\n\n\nThis whole approach we have taken in this course, is not what I would describe as ‚Äúthe standard way‚Äù to make an R package. This represents a bit of a funny situation, where we have taken an existing workflow, and then morphed things into an R package. The benefits to this are that it is useful for teaching. And sometimes, this is how things happen.",
    "crumbs": [
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Create the package!</span>"
    ]
  },
  {
    "objectID": "how-to-use-extra-pkgs.html",
    "href": "how-to-use-extra-pkgs.html",
    "title": "8¬† How to use extra packages",
    "section": "",
    "text": "8.1 use_package(&lt;pkg&gt;) andpkg::fun()`\nOne of the major shifts from writing R code and analyses to writing R packages is how you interact with other R packages you want to use.\nNormally, in an R script, when you want to use a function from, say, dplyr, you use library(dplyr).\nHowever, we do not ever want to call library(dplyr) inside a function in an R package. The reason is to do with NAMESPACE conflicts. A popular usecase of this is in the tidyverse R package - where we get this message when we call library(tidyverse).\nThe conflict message at the bottom tells us that dplyr::filter() masks stats::filter().\nThis is a key issue with package development - masking. If all R packages called library(&lt;package&gt;) on every R package that they depended upon, then we‚Äôd have SO MUCH masking. It‚Äôs almost considered rude or overbearing.\nYou say? The solution is to use what is called the ‚Äúnamespaced‚Äù form: pkg::fun().\nFor example, if I want to use filter from dplyr, I do so with:\nSo for every package we want to use a function from in an R package, we use the ‚Äúnamespaced form‚Äù, e.g., dplyr::filter(). We also have to declare the dependencies formally, which I‚Äôll discuss now.\nSo now we need to identify the packages that we use in our R package, and then namespace them. We then formally add the dependency with: use_package(&lt;pkg&gt;).\nFor example, looking at\nWe turn it into its namespaced form like so:\nAnd then call use_package():\nWhich gives us a nice chatty response from usethis:\nYou can see this at this commit\nSee this commit for what you should end up with.",
    "crumbs": [
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>How to use extra packages</span>"
    ]
  },
  {
    "objectID": "how-to-use-extra-pkgs.html#use_packagepkg-andpkgfun",
    "href": "how-to-use-extra-pkgs.html#use_packagepkg-andpkgfun",
    "title": "8¬† How to use extra packages",
    "section": "",
    "text": "boxplot_study_state &lt;- function(data) {\n  ggplot(\n    data,\n    aes(\n      x = prop_studying,\n      y = state_territory\n    )\n  ) +\n    geom_boxplot()\n}\n\nboxplot_study_state &lt;- function(data) {\n  ggplot2::ggplot(\n    data,\n    ggplot2::aes(\n      x = prop_studying,\n      y = state_territory\n    )\n  ) +\n    ggplot2::geom_boxplot()\n}\n\nuse_package(\"ggplot2\")\n\n‚úî Setting active project to\n  \"/Users/nick/github/njtierney/learned\".\n‚úî Adding ggplot2 to Imports field in DESCRIPTION.\n‚òê Refer to functions with `ggplot2::fun()`.\n\n\n\n\n\n\n\nYour turn\n\n\n\n\nIdentify all the R packages used in learned\ncall use_package() on each of these packages\nNamespace all the functions\n\n\n\n\n\n\n\n\n\n\nHow many dependencies should you have?\n\n\n\nMy opinion is that you should depend on as many R packages as you like! It‚Äôs far faster, I think, to depend on packages that get the job done, and then maybe later trim back some dependencies and rewrite code.\nMy reasoning is that it is (generally) really cheap to add dependencies, but more expensive (for my brain), to write them from scratch.\nSo, be greedy, add dependencies, then prune back.",
    "crumbs": [
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>How to use extra packages</span>"
    ]
  },
  {
    "objectID": "how-to-use-extra-pkgs.html#demo-in-scratch",
    "href": "how-to-use-extra-pkgs.html#demo-in-scratch",
    "title": "8¬† How to use extra packages",
    "section": "8.2 Demo in scratch",
    "text": "8.2 Demo in scratch\nNow that we‚Äôve done this, let‚Äôs install the package, and then go to scratch.R\nI then get this error:\n&gt; clean_education_data(raw_education_2014)\nError in clean_education_data(raw_education_2014) : \n  could not find function \"clean_education_data\"\nHowever, if we do load all, with:\nload_all(\".\")\nThen it works!\nBut what gives with the function not being available? Let‚Äôs have a look inside learned by using :::\nThere‚Äôs nothing in there! Now let‚Äôs focus on getting that working, which will involve learning about documenting our code!\n\n\n\n\n\n\nThe tidyverse package is not a dependency in packages\n\n\n\n\n\nBecause the purpose of the R package tidyverse is only really to load other R packages, it does not contain functions. Don‚Äôt put tidyverse in imports.\n\n\n\n\n\n\n\n\n\nManaging conflicts in scripts with conflicted\n\n\n\n\n\nOutside of the R package development world, it‚Äôs a good idea to proactively manage function conflicts. Lest you use stats::filter() instead of dplyr::filter()\nSee the conflicted R package for more on this idea.\n\n\n\n\n\n\n\n\n\nSome other ideas\n\n\n\n\n\n\nImports vs Depends. We only really use Imports. Don‚Äôt use Depends unless you‚Äôre building an extension package, e.g., something that works with ggplot2, where it doesn‚Äôt make sense to have the package without ggplot2. Depends is like having library(pkg). Generally, don‚Äôt do it.\nIt‚Äôs usually a good idea to state package versions after their name in Imports. Find out the package name with packageVersion(\"pkg\"). Generally onlt do &gt;=, and not == and never &lt;",
    "crumbs": [
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>How to use extra packages</span>"
    ]
  },
  {
    "objectID": "add-documentation.html",
    "href": "add-documentation.html",
    "title": "9¬† Add documentation",
    "section": "",
    "text": "So we noticed that there was nothing in learned when we looked at it - the reason is that we need to export the functions. To do this, we need to document our functions using roxygen2.\nIn short, roxygen2 provides us with nifty syntax to give documentation to our functions, which also allows them to be exported.\nLet‚Äôs demonstrate with boxplot_study_state.R:\nIt starts like this:\nboxplot_study_state &lt;- function(data) {\n  ggplot2::ggplot(\n    data,\n    ggplot2::aes(\n      x = prop_studying,\n      y = state_territory\n    )\n  ) +\n    ggplot2::geom_boxplot()\n}\nAnd we can add a ‚Äúroxygen skeleton‚Äù by going to code &gt; insert roxygen skeleton (or with Alt/Option + Ctrl/Cmd + Shift + R) whilst our cursor is in the function, and we get this:\n#' Title\n#'\n#' @param data \n#'\n#' @returns\n#' @export\n#'\n#' @examples\nboxplot_study_state &lt;- function(data) {\n  ggplot2::ggplot(\n    data,\n    ggplot2::aes(\n      x = prop_studying,\n      y = state_territory\n    )\n  ) +\n    ggplot2::geom_boxplot()\n}\nWhich we can then populate:\n#' Provide a boxplot of study data\n#'\n#' @param data data from education 2014\n#'\n#' @returns a ggplot object\n#' @export\n#'\n#' @examples\n#' # no example data yet\nboxplot_study_state &lt;- function(data) {\n  ggplot2::ggplot(\n    data,\n    ggplot2::aes(\n      x = prop_studying,\n      y = state_territory\n    )\n  ) +\n    ggplot2::geom_boxplot()\n}\nWe then call document(), which gives us the output:\n‚Ñπ Updating learned documentation\n‚Ñπ Loading learned\nWriting NAMESPACE\nWriting boxplot_study_state.Rd\nThis allows us to look at the documented function with ?boxplot_study_state.\nThis function also gets added to the NAMESPACE file.\nHere‚Äôs the commit of that\nNote three things:\n\nNAMESPACE now has boxplot_study_state.R in it\nWe have added some roxygen code\nThere‚Äôs some LaTeX looking code in man/boxplot_study_state.Rd\n\n\n\n\n\n\n\nYour Turn\n\n\n\n\nRepeat this process for all the remaining functions in learned\n\nadd the roxygen skeleton\npopulation the roxygen skeleton\nrun document()\n\n\n\n\nSee this commit to see what this looks like when done.\nSo now we have some functions in our package! Woo!\nFor fun, try looking at the documentation with ?clean_age_groups\nWhat‚Äôs missing from these functions? Examples! For examples, we need our data! Let‚Äôs add that to the package.",
    "crumbs": [
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Add documentation</span>"
    ]
  },
  {
    "objectID": "add-data.html",
    "href": "add-data.html",
    "title": "10¬† Adding data to an R package",
    "section": "",
    "text": "10.1 Reading and exporting the data\nWe want examples - and we want to show our data! So let‚Äôs add the raw education 2014 data to the package.\nTo do this, we‚Äôre going to navigate back to the data-raw/DATASET.R file.\nThis file is effectively a data cleaning script - in our case, we‚Äôre just going to read in the data, then use usethis::use_data() on it to export it. Then we will document the data.\nCurrently, our DATASET.R file looks like this:\nLet‚Äôs read in the data and then export it, so it will look like this:\n(compress = \"xz\" is a very efficient storage format)\nOnce again, usethis gives us a nice chatty response:\nWith a little note about documenting your data!\nTo finish this off, we need to document the data. This looks like us creating a new R file, that contains some information like this:\nI usually save this in R under something like data-&lt;NAME&gt;\nSee this commit for what this looks like.",
    "crumbs": [
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>Adding data to an R package</span>"
    ]
  },
  {
    "objectID": "add-data.html#reading-and-exporting-the-data",
    "href": "add-data.html#reading-and-exporting-the-data",
    "title": "10¬† Adding data to an R package",
    "section": "",
    "text": "## code to prepare `DATASET` dataset goes here\n\nusethis::use_data(DATASET, overwrite = TRUE)\n\n## 2015-04-10\nlibrary(readr)\nraw_education_2014 &lt;- read_csv(\"data-raw/raw_education_2014.csv\")\n\nusethis::use_data(raw_education_2014, overwrite = TRUE, compress = \"xz\")\n\n\n‚úî Setting active project to\n  \"/Users/nick/github/njtierney/learned\".\n‚úî Adding R to Depends field in DESCRIPTION.\n‚úî Creating data/.\n‚úî Setting LazyData to \"true\" in DESCRIPTION.\n‚úî Saving \"raw_education_2014\" to\n  \"data/raw_education_2014.rda\".\n‚òê Document your data (see\n  &lt;https://r-pkgs.org/data.html&gt;).\n\n\n\n\n\n\n\nYour turn\n\n\n\n\nExport the 2014 data, as described above\n\nSee this commit for a demonstration\n\n\n\n#' ABS Education data\n#'\n#' Some education data used for practicing building R packages.\n#'   Each row represents the number of people studying in a given age group in \n#'   a given state.\n#'\n#' @format ## `raw_education_2014`\n#' A data frame with 72 rows and 6 columns:\n#' \\describe{\n#'   \\item{year}{The year of data - 2014}\n#'   \\item{state_territory}{One of 8 states or territories}\n#'   \\item{age_group}{age groups from 15 to 44}\n#'   \\item{n_studying}{how many people are studying}\n#'   \\item{population}{population in that state in that}\n#'   \\item{prop_studying}{proportion studying}\n#' }\n#' @source &lt;https://www.who.int/teams/global-tuberculosis-programme/data&gt;\n\"raw_education_2014\"\n\n\n\n\n\n\n\nYour turn\n\n\n\n\nDocument your data\nRun document()",
    "crumbs": [
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>Adding data to an R package</span>"
    ]
  },
  {
    "objectID": "add-data.html#improve-our-examples-with-our-data",
    "href": "add-data.html#improve-our-examples-with-our-data",
    "title": "10¬† Adding data to an R package",
    "section": "10.2 Improve our examples with our data",
    "text": "10.2 Improve our examples with our data\nNow that we have some data easily accessible, we can go back and fix our examples in documentation!\nFor example, in boxplot_study_state.R we can change\n#' @examples\n#' # no example data yet\nTo\n#' @examples\n#' boxplot_study_state(raw_education_2014)\nSee this commit\n\n\n\n\n\n\nYour turn\n\n\n\n\nAdd the example data to all functions in learned\nrun document()\n\n\n\nSee this commit to see what this looks like.\nWe‚Äôre getting close now - let‚Äôs see if we can pass checks!",
    "crumbs": [
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>Adding data to an R package</span>"
    ]
  },
  {
    "objectID": "using-checks.html",
    "href": "using-checks.html",
    "title": "11¬† Passing Checks",
    "section": "",
    "text": "11.1 Check can sometimes open a can of worms\nOur package is really starting to grow up on us!\nBut it‚Äôs time to test it - we do this with devtools::check()\nThis function runs all the general tests to see if our package can go onto CRAN. There are usually a few more checks to run, but it‚Äôs mostly 95% of the way there.\nEssentially, devtools::check() does the following:\nIt does usually take a minute or so to do, so it‚Äôs not something we run all the time, but it‚Äôs a good idea to get into a habit of being somewhat regular about the checks.\nLet‚Äôs run devtools::check() on learned\nWe pretty quickly get an error!\nLet‚Äôs take a full look at the vignette error:\nOK, so the issue is that we are reading in the CSV in a non standard way. But, now that we have the data built in to the package, we don‚Äôt need to worry about this.\nIn fact, looking at the vignette now, there‚Äôs a few things going on!\nWe resolve this at this commit.\nEven as an experienced package developer, once I fixed the above, I still had quite a few things to fix. Let‚Äôs walk through these.\nWe also introduce a new error:\nWhich I believe is fixed by adding quarto to Suggests - done in this commit.\nDoing that, and running check() we now get a bit more of thata can of worms of errors, warnings, and notes:\nThis all looks a bit intense. It‚Äôs OK. We will get through.\nStart by tackling the ERRORs.",
    "crumbs": [
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>Passing Checks</span>"
    ]
  },
  {
    "objectID": "using-checks.html#check-can-sometimes-open-a-can-of-worms",
    "href": "using-checks.html#check-can-sometimes-open-a-can-of-worms",
    "title": "11¬† Passing Checks",
    "section": "",
    "text": "‚ùØ checking package dependencies ... ERROR\n  VignetteBuilder package not declared: ‚Äòquarto‚Äô\n  \n  See section ‚ÄòThe DESCRIPTION file‚Äô in the ‚ÄòWriting R Extensions‚Äô\n  manual.\n\n\nSuggests is a place where you put packages that are used in your vignettes, but not your package.\n\n\n‚ùØ checking re-building of vignette outputs ... ERROR\n  Error(s) in re-building vignettes:\n  --- re-building ‚Äòanalysis-2014.qmd‚Äô using html\n  \n  \n  processing file: analysis-2014.qmd\n  Error in library(naniar) : there is no package called 'naniar'\n  Calls: .main ... withCallingHandlers -&gt; withVisible -&gt; eval -&gt; eval -&gt; library\n  \n  Quitting from analysis-2014.qmd:35-39 [libraries]\n  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  &lt;error/rlang_error&gt;\n  Error in `library()`:\n  ! there is no package called 'naniar'\n  ---\n  Backtrace:\n      ‚ñÜ\n   1. ‚îî‚îÄbase::library(naniar)\n  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  \n  Execution halted\n  Error: processing vignette 'analysis-2014.qmd' failed with diagnostics:\n  ‚úñ Error running quarto cli.\n  Caused by error:\n  ! System command 'quarto' failed\n  --- failed re-building ‚Äòanalysis-2014.qmd‚Äô\n  \n  SUMMARY: processing the following file failed:\n    ‚Äòanalysis-2014.qmd‚Äô\n  \n  Error: Vignette re-building failed.\n  Execution halted\n\n‚ùØ checking DESCRIPTION meta-information ... WARNING\n  Invalid license file pointers: LICENSE\n\n‚ùØ checking R code for possible problems ... NOTE\n  boxplot_study_state: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  boxplot_study_state: no visible binding for global variable\n    ‚Äòstate_territory‚Äô\n  clean_education_data: no visible binding for global variable\n    ‚Äòage_group‚Äô\n  clean_education_data: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  plot_study_age_state: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  plot_study_age_state: no visible binding for global variable\n    ‚Äòage_group‚Äô\n  summarise_prop_study: no visible binding for global variable\n    ‚Äòstate_territory‚Äô\n  summarise_prop_study: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  summarise_prop_study: no visible global function definition for\n    ‚Äòquantile‚Äô\n  summarise_prop_study: no visible global function definition for\n    ‚Äòmedian‚Äô\n  summarise_prop_study: no visible global function definition for ‚Äòsd‚Äô\n  Undefined global functions or variables:\n    age_group median prop_studying quantile sd state_territory\n  Consider adding\n    importFrom(\"stats\", \"median\", \"quantile\", \"sd\")\n  to your NAMESPACE file.\n\n‚ùØ checking for unstated dependencies in vignettes ... NOTE\n  'library' or 'require' call not declared from: ‚Äònaniar‚Äô\n\n1 error ‚úñ | 1 warning ‚úñ | 2 notes ‚úñ\n\n\n\n11.1.1 Packages used in vignettes have to be declared in Suggests\nThis error\n‚ùØ checking re-building of vignette outputs ... ERROR\n  Error(s) in re-building vignettes:\n  --- re-building ‚Äòanalysis-2014.qmd‚Äô using html\n  \n  \n  processing file: analysis-2014.qmd\n  Error in library(tidyverse) : there is no package called 'tidyverse'\n  Calls: .main ... withCallingHandlers -&gt; withVisible -&gt; eval -&gt; eval -&gt; library\n  \n  Quitting from analysis-2014.qmd:35-41 [libraries]\n  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  &lt;error/rlang_error&gt;\n  Error in `library()`:\n  ! there is no package called 'tidyverse'\n  ---\n  Backtrace:\n      ‚ñÜ\n   1. ‚îî‚îÄbase::library(tidyverse)\n  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  \n  Execution halted\n  Error: processing vignette 'analysis-2014.qmd' failed with diagnostics:\n  ‚úñ Error running quarto cli.\n  Caused by error:\n  ! System command 'quarto' failed\n  --- failed re-building ‚Äòanalysis-2014.qmd‚Äô\n  \n  SUMMARY: processing the following file failed:\n    ‚Äòanalysis-2014.qmd‚Äô\n  \n  Error: Vignette re-building failed.\n  Execution halted\nWe actually don‚Äôt need some of these packages anymore - so let‚Äôs remove tidyverse, and here.\nThen, doing that, we still get a similar error, but just for the ‚Äúnaniar‚Äù package.\nWe can resolve this by doing\nuse_package(\"naniar\", type = \"Suggests\")\nThis works!\nThat puts at at this commit\nWe now have this state\n‚ùØ checking DESCRIPTION meta-information ... WARNING\n  Invalid license file pointers: LICENSE\n\n‚ùØ checking R code for possible problems ... NOTE\n  boxplot_study_state: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  boxplot_study_state: no visible binding for global variable\n    ‚Äòstate_territory‚Äô\n  clean_education_data: no visible binding for global variable\n    ‚Äòage_group‚Äô\n  clean_education_data: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  plot_study_age_state: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  plot_study_age_state: no visible binding for global variable\n    ‚Äòage_group‚Äô\n  summarise_prop_study: no visible binding for global variable\n    ‚Äòstate_territory‚Äô\n  summarise_prop_study: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  summarise_prop_study: no visible global function definition for\n    ‚Äòquantile‚Äô\n  summarise_prop_study: no visible global function definition for\n    ‚Äòmedian‚Äô\n  summarise_prop_study: no visible global function definition for ‚Äòsd‚Äô\n  Undefined global functions or variables:\n    age_group median prop_studying quantile sd state_territory\n  Consider adding\n    importFrom(\"stats\", \"median\", \"quantile\", \"sd\")\n  to your NAMESPACE file.\n\n0 errors ‚úî | 1 warning ‚úñ | 1 note ‚úñ\n\n\n\n11.1.2 Addressing the warning\n‚ùØ checking DESCRIPTION meta-information ... WARNING\n  Invalid license file pointers: LICENSE\nLet‚Äôs look at the DESCRIPTION file, and at the License section\nIt says:\nLicense: MIT + file LICENSE\nWe didn‚Äôt initialise the License properly, so we run\nuse_mit_license()\nWhich gives us\n‚úî Writing LICENSE.\n‚úî Writing LICENSE.md.\n‚úî Adding \"^LICENSE\\\\.md$\" to .Rbuildignore.\ncheckpoint this commit\n\n\n11.1.3 The NOTES\nRunning Check again, we are down to the NOTEs:\n‚ùØ checking R code for possible problems ... NOTE\n  boxplot_study_state: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  boxplot_study_state: no visible binding for global variable\n    ‚Äòstate_territory‚Äô\n  clean_education_data: no visible binding for global variable\n    ‚Äòage_group‚Äô\n  clean_education_data: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  plot_study_age_state: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  plot_study_age_state: no visible binding for global variable\n    ‚Äòage_group‚Äô\n  summarise_prop_study: no visible binding for global variable\n    ‚Äòstate_territory‚Äô\n  summarise_prop_study: no visible binding for global variable\n    ‚Äòprop_studying‚Äô\n  summarise_prop_study: no visible global function definition for\n    ‚Äòquantile‚Äô\n  summarise_prop_study: no visible global function definition for\n    ‚Äòmedian‚Äô\n  summarise_prop_study: no visible global function definition for ‚Äòsd‚Äô\n  Undefined global functions or variables:\n    age_group median prop_studying quantile sd state_territory\n  Consider adding\n    importFrom(\"stats\", \"median\", \"quantile\", \"sd\")\n  to your NAMESPACE file.\n\nOK, so there‚Äôs two things here:\n\nwe forgot to namespace median, quantile, and sd\nWe need to deal with ‚ÄúUndefined global functions or variables: age_group median prop_studying quantile sd state_territory‚Äù\n\nThe latter one is more painful, let‚Äôs deal with this.\nEssentially, R is complaining because we use these variables inside dplyr code, and it doesn‚Äôt know where they come from. My preferred way of dealing with this is using a function called globalVariables. I usually do this inside a centralised R function in what is called a ‚Äúpackage doc file‚Äù.\nWe can create this file with:\nuse_package_doc()\nWhich tells us:\n‚úî Writing R/learned-package.R.\n‚òê Modify R/learned-package.R.\n‚òê Run devtools::document() to update package-level\n  documentation.\nAnd then inside that file I put age_group median prop_studying quantile sd state_territory. It ends up looking like this:\n#' @keywords internal\n\"_PACKAGE\"\n\n## usethis namespace: start\n## usethis namespace: end\nNULL\n\nglobalVariables(c(\n  \"age_group\",\n  \"median\",\n  \"prop_studying\",\n  \"quantile\",\n  \"sd\",\n  \"state_territory\"\n))\nSo now, let‚Äôs run document(), and then run check() again.\nAnd now we are clear! This actually solved the other problem‚Ä¶which is a bit mysterious, but that‚Äôs sometimes how it goes.\nHere is the commit of this.",
    "crumbs": [
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>Passing Checks</span>"
    ]
  },
  {
    "objectID": "push-to-github.html",
    "href": "push-to-github.html",
    "title": "12¬† Pushing it to GitHub",
    "section": "",
    "text": "We can pretty much achieve this with:\n\nuse_git()\nuse_github()\n\nDiscuss the benefits and tools of: - issues - releases - milestones - projects",
    "crumbs": [
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Pushing it to GitHub</span>"
    ]
  },
  {
    "objectID": "add-readme.html",
    "href": "add-readme.html",
    "title": "13¬† Adding a README file",
    "section": "",
    "text": "Take the vignette, make it small.\nThis is your README\nuse_readme_rmd()\nNow github looks a bit neater!",
    "crumbs": [
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Adding a README file</span>"
    ]
  },
  {
    "objectID": "add-tests.html",
    "href": "add-tests.html",
    "title": "14¬† Using tests",
    "section": "",
    "text": "use_testthat()\nre-examine data quality checks\nexplain moving from less-formal to more formalised approach\ndemonstrate testing dimensions/names\ndemonstrate snapshot tests\n\nexpect_snapshot(clean_data(raw_education_2014))\n\ndemonstrate vdiffr tests\n\nset.seed(2025-04-11)\nplot_name &lt;- plot_code(data)\n\ntest_that(\"plot works\", {\n  skip_on_cran()\n  skip_on_ci()\n  vdiffr::expect_doppelganger(\"plot_name\", plot_name)\n})\n\ncircle back to the data quality checks\ntouch on the idea that R packages can be used for other things than CRAN - although this does maybe go against some ideas in this course, the R package structure can be exploited to do some cool things - like perhaps data validation?\nreference Miles‚Äôs https://milesmcbain.xyz/posts/an-okay-idea/",
    "crumbs": [
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>Using tests</span>"
    ]
  },
  {
    "objectID": "add-website.html",
    "href": "add-website.html",
    "title": "15¬† Adding a website",
    "section": "",
    "text": "pkgdown\nuse_pkgdown_github_pages()\nlook at other packages for inspiration on structure\ntry to use a different default theme",
    "crumbs": [
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Adding a website</span>"
    ]
  },
  {
    "objectID": "add-ci.html",
    "href": "add-ci.html",
    "title": "16¬† Using Continuous Integration",
    "section": "",
    "text": "use_github_action() (singular)\n\nfollow prompts\n\nThis is all much easier than it used to be\nExplain that there is a game of ‚Äúwatching the green lights‚Äù\nExplain test coverage\n\nsee covr::report()",
    "crumbs": [
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Using Continuous Integration</span>"
    ]
  },
  {
    "objectID": "publish.html",
    "href": "publish.html",
    "title": "17¬† Publishing your R package",
    "section": "",
    "text": "17.1 github",
    "crumbs": [
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Publishing your R package</span>"
    ]
  },
  {
    "objectID": "publish.html#github",
    "href": "publish.html#github",
    "title": "17¬† Publishing your R package",
    "section": "",
    "text": "Ease of use\nslow\nDiscuss risks of building/installing from github",
    "crumbs": [
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Publishing your R package</span>"
    ]
  },
  {
    "objectID": "publish.html#cran",
    "href": "publish.html#cran",
    "title": "17¬† Publishing your R package",
    "section": "17.2 CRAN",
    "text": "17.2 CRAN\n\nA few barriers\nvery stable, fast",
    "crumbs": [
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Publishing your R package</span>"
    ]
  },
  {
    "objectID": "publish.html#r-universe",
    "href": "publish.html#r-universe",
    "title": "17¬† Publishing your R package",
    "section": "17.3 R Universe",
    "text": "17.3 R Universe\n\nsimilar to CRAN speed wise\nlinked to github\nfewer barriers\nhttps://docs.r-universe.dev/publish/set-up.html",
    "crumbs": [
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Publishing your R package</span>"
    ]
  },
  {
    "objectID": "next-steps.html",
    "href": "next-steps.html",
    "title": "18¬† Next Steps",
    "section": "",
    "text": "R packages book\nofficial R docs\nrOpenSci docs\n\nSubmitting to CRAN\nSubmitting to JOSS\nSubmitting to rOpenSci",
    "crumbs": [
      "<span class='chapter-number'>18</span>¬† <span class='chapter-title'>Next Steps</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "R Package Essentials",
    "section": "",
    "text": "R packages book\nHilary Parker‚Äôs blog post\nrOpenSci dev guide",
    "crumbs": [
      "<span class='chapter-number'>19</span>¬† <span class='chapter-title'>references.html</span>"
    ]
  },
  {
    "objectID": "acknowledgements.html",
    "href": "acknowledgements.html",
    "title": "R Package Essentials",
    "section": "",
    "text": "Hadley Wickham\nJenny Bryan\nMiles McBain\nJoe Cheng\nDi Cook\nRob Hyndman\nKerrie Mengersen\nDamjan Vukcevic\nMatt Moores",
    "crumbs": [
      "<span class='chapter-number'>20</span>¬† <span class='chapter-title'>acknowledgements.html</span>"
    ]
  }
]